{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"What is Postal3Script? Postal3Script, or P3S, is a scripting language developed for Postal 3, designed to handle most of the NPC AI and mission scripting. It allows for a much easier and faster time doing missions and AI rather than messing around in C++ and doing logic entirely through map entities in Hammer. With Postal3Script, you can easily do many things that you normally would not be able to do without the source code of the game due to the many useful functions and attributes that are interfaced. P3S script files are located in \"/Postal III/p3/scripts\" and use the \".p3s\" file extension. To load and be able to use a p3s script, you must add it to a manifest, in \"ai_scripts.txt\", found in the previously mentioned folder. Changes to p3s scripts will automatically hotload when the map restarts, so you can just use the \"restart\" console command without ever having to exit and reload the game. It is highly recommended to snoop around the game files and find examples of what you're trying to accomplish to get a better idea of the language. Postal3Script Example Constants { Const DONUTS_INCR,1 Const SOMEBODY_STOLE_MY_DONUTS,15 Const YES,1 Const NO,0 } behavior { name bh_evensuperioractor inherited bh_mysuperioractor States { st_mycustomstate { Group Alert Patterns { pt_default { // Only executes when on Alert } } } st_nowyallgonnapay { Group Combat Patterns { pt_default { // Only executes when in Combat SetAttr \"veryverypissedoff YES\" Pattern pt_donuts } pt_donuts { IfAttr \"veryverypissedoff == YES Pattern st_nowyallgonnapay.pt_allgood\" } pt_allgood { SetAttr \"veryverypissedoff NO\" } } } events { OnDeath \"ExecutePattern st_OnDeath.pt_default\" OnTimer_tUnstun \"Pattern pt_end\" OnUnconscious \"Pattern pt_unconscious\" OnHostaged \"Pattern pt_hostaged\" OnSprayStunned \"Timer tUnstun,SPRAY_UNSTUN_TIMER\" OnTimer_tScream \"ExecutePattern .xpt_SayScream\" OnUnstunned \"Pattern pt_end\" OnStandUpEnd \"Pattern pt_end\" } // Sets on spawn st_init { Group Neutral Patterns { pt_default { actions { Senses false } } } } // Called continously st_start { Group Neutral Patterns { pt_default { actions { // tick } } } } } } Limitations Each state can hold events, which in turn can execute patterns. Patterns can be inherited from other P3S actors, as well as Attributes. * In Postal3Script, Attributes can only be whole numbers/integers, attributes can't be floats, doubles and strings. * An Attribute must have a value initialized before checking it's value using CheckAttr, meaning an attribute that doesn't exist will never return a valid value. (Checking if it's zero/null doesn't work). * You can only have a limited number of if statements in a single state or pattern. Debugging code Normally the game doesn't print out any errors, you need to have the \"developer\" and \"p3_fsm_spew\" console commands enabled. Scrolling around in the console should show you which script and what lines have errors if there are any. If you want to print out your own debug messages, You'll have to settle for doing EntFireInput on the point_clientcommand in the map via \"EntFireInput pcc,Command: echo yourmessagehere\". Debug channel specific ShowMessages are broken it seems. Unused Postal3Script files Trashmasters have left many p3s scripts that were used during the development of Postal III just sitting around. Many of them contain cut features, unused logic, and various tests. 'ai_badger_test.p3s' - Badger testing 'ai_cashmart.p3s' - Earlier version of Cashmart (ai_cashmart_npc.p3s is not unused) 'ai_gameplay.p3s' - Intended for Open World gameplay 'ai_patrol1_citizen_fight.p3s' - Unknown 'ai_st1_common.p3s' - Contains various old code 'ai_st2_states.p3s' - Contains various old code 'ai_st3_social.p3s' - Contains experimental old code 'ai_st4_queuie.p3s' - Queue testing 'ai_st5_temp.p3s' - Contains test code, scrapped features 'ai_st6_missions.p3s' - Test code related to missions 'ai_st7_environment.p3s' - Code related to cut environment behavior 'ai_st8_items.p3s' - Code related to cut inventory items 'ai_st9_animals.p3s' - Animals test 'ai_st10_temp.p3s' - Test script, contains code related to Traffic lights 'ai_st11_urza.p3s' - Contains scrapped features, old code 'ai_st12_urza.p3s' - Contains scrapped features, old code 'ai_st98_helicopter.p3s' - Code that's identical to today's Helicopter AI 'ai_st_utilities.p3s' - Various code related to NPCs 'ai_test_babuska.p3s' - Test script 'lean_test.p3s' - Test script","title":"What is Postal3Script?"},{"location":"#what-is-postal3script","text":"Postal3Script, or P3S, is a scripting language developed for Postal 3, designed to handle most of the NPC AI and mission scripting. It allows for a much easier and faster time doing missions and AI rather than messing around in C++ and doing logic entirely through map entities in Hammer. With Postal3Script, you can easily do many things that you normally would not be able to do without the source code of the game due to the many useful functions and attributes that are interfaced. P3S script files are located in \"/Postal III/p3/scripts\" and use the \".p3s\" file extension. To load and be able to use a p3s script, you must add it to a manifest, in \"ai_scripts.txt\", found in the previously mentioned folder. Changes to p3s scripts will automatically hotload when the map restarts, so you can just use the \"restart\" console command without ever having to exit and reload the game. It is highly recommended to snoop around the game files and find examples of what you're trying to accomplish to get a better idea of the language.","title":"What is Postal3Script?"},{"location":"NPC/","text":"NPC Kills current NPC executed from script Syntax NPC kill, [fade out time] -- Kills NPC with time waiting for fading out Example // This will kill the NPC after 1 second after execution xpt_KillMyself { actions { Wait 1 NPC kill } } // This will make the NPC fade out in 2.5 seconds xpt_Disappear { actions { NPC kill, 2.5 } }","title":"NPC"},{"location":"NPC/#npc","text":"Kills current NPC executed from script","title":"NPC"},{"location":"TBD/","text":"Unfinished! This page of Postal3Script has not worked on yet! Sorry! We're working on it!","title":"SetActPack (TBD)"},{"location":"TBD/#unfinished","text":"This page of Postal3Script has not worked on yet! Sorry! We're working on it!","title":"Unfinished!"},{"location":"activitypattern_funcs/","text":"Note: It's advised to not use these functions - StoreActivityPattern Unused Postal3Script function Stores an Activity Pattern Syntax StoreActivityPattern [string] -- Stores a pattern from current state Example st_mycustomstate { group Neutral patterns { pt_default { actions { // This will store pt_ketchup from the current state StoreActivityPattern pt_ketchup } } pt_ketchup { actions { ChangeAttr \"Ketchup +1\" } } } } - ExecuteActivityPattern Unused Postal3Script function Executes Activity Pattern Syntax ExecuteActivityPattern true -- Executes currently stored pattern - ClearActivityPattern Unused Postal3Script function Clears Activity Pattern Syntax ClearActivityPattern true -- Clears currently stored pattern","title":"StoreActivityPattern, ExecuteActivityPattern, ClearActivityPattern"},{"location":"addfluid/","text":"AddFluid Spawns gasoline trails at a specified location Only ever used in Paradise Bridge level. Syntax AddFluid [xpos] [ypos] [zpos] [amount] -- Spawns trails Default Amount is 300 if no Amount was defined Example // from ai_mission_pdb.p3s pt_default { actions { Wait 0.9 EntFireInput tutor03_teleport,Teleport EntFireInput \"pcc,Command:use p3_weapon_emptyhands\" EntFireInput \"lpp,RemoveWeapon:p3_weapon_grenade\" // Spawn Gasoline trails at this location AddFluid \"171,670,100,300000\" AddFluid \"-318,931,80,300000\" AddFluid \"150,925,100,100000\" AddFluid \"-110,1030,80,200000\" // This would also spawn Gasoline trails at this location AddFluid \"300,312,100\" EntFireInput \"pcc,Command:give p3_weapon_match\" Wait 0.5 MissionLog \"add_primary,tutor04,#P3_PDB_T04_LOG\" ShowMessage #P3_PDB_T04_MSG01 } events { OnTutor04ZombiesDead \"Pattern pt_end\" } }","title":"AddFluid"},{"location":"addfluid/#addfluid","text":"Spawns gasoline trails at a specified location Only ever used in Paradise Bridge level.","title":"AddFluid"},{"location":"arm/","text":"Arm Deleted Postal3Script function Sets melee status for the NPC, superseded by \"Weapon\" Syntax Arm [boolean], melee -- Sets melee status, and holsters weapon if possible Example // from ai_st11_urza.p3s pt_arm_melee { actions { Block Begin,Execute Aim false Arm True,melee IfAttr \"ea_status < 1 SetAttr ea_status 1\" Block End } }","title":"Arm"},{"location":"arm/#arm","text":"Deleted Postal3Script function Sets melee status for the NPC, superseded by \"Weapon\"","title":"Arm"},{"location":"assisttarget_enemy/","text":"- AssistTarget Sets current target as target internally Syntax AssistTarget 1 -- Sets current target as target internally Example pt_npcdead { actions { IfAttr \"ea_Manner == Manner:JusticeMan Block begin\" TargetCaller 1 Weapon select,ranged AssistTarget 1 Relationship target,enemy State st_start Block end } } - AssistEnemy Unused Postal3Script function Sets current target's enemy as target Syntax AssistEnemy 1 -- Sets current target's enemy as target - ArrestTarget Unused Postal3Script function Arrests the target, only works for Player Only works for \"p3_npc_cop\" NPCs Syntax ArrestTarget true -- Target is arrested ArrestTarget false -- Target is no arrested Example // from ai_st5_temp.p3s st_test_arrest { group Neutral patterns { pt_arrest { actions { FreeMovement false TargetPlayer 1 ArrestTarget true Wait 30 ArrestTarget false State st_start } } } } - BusyTarget Unused Postal3Script function Sets target's busy state internally Can target self Syntax BusyTarget true -- Target is busy BusyTarget false -- Target is no longer busy Example // from ai_st11_urza.p3s st_p3_buy_cash { group Neutral patterns { pt_default { actions { BusyTarget true // SELLER IS BUSY targetToMem 2 // mem2 is seller targetFromMem 1 // target is thing FreeMovement false Sequence itm_discard WaitForEnd 1 targetFromMem 2 //target is seller FireEvent NeedBuy } } } } - CheckTarget Checks if target is visible Syntax CheckTarget 1 -- Target is checked Technical Details If target is busy and exists, an event called \"OnTargetReset\" will be fired with the target being the caller, and the NPC that called CheckTarget will get their target nulled out. If that check fails, NPC will forget their target, look for potential targets, and fire \"OnVisible\" event with the target being the caller If even that fails, the event \"OnTargetReset\" will be fired on the NPC. Example // from ai_mission_pdb.p3s pt_move { actions { MoveToTarget walk,0 Wait 2:5 Say ZOMB_MOAN,ZOMB_CURSE,0 CheckTarget 1 Repeat 1 } events { OnVisible \"Pattern pt_barf\" } } - CheckLOS Checks if target is able to see the caller Syntax CheckLOS 1 -- Checks target's line of sight Technical Details Fires event \"OnLOS\" if target is able to see the caller Example // from ai_mission_pm2.p3s pt_loop { actions { // Target can't see us, perfect, kill ourselves IfAttr \"Timer:tKill < = 0 Npc kill\" CheckLOS 1 Repeat 1 } events { // The timer's counter will be reset to 3 everytime the target is able to see OnLOS \"Timer tKill,3\" } }","title":"AssistTarget, AssistEnemy, ArrestTarget, BusyTarget, CheckTarget, CheckLOS"},{"location":"assisttarget_enemy/#-assisttarget","text":"Sets current target as target internally","title":"- AssistTarget"},{"location":"attributeprogressbar/","text":"AttributeProgressBar Add a panel with a progress bar on the HUD with an associated attribute for the \"progress\" value. Used for displaying boss/ally health bars and portraits in missions. Uses .res files located in \"Postal III/p3/resource/UI/Hud/\". Syntax AttributeProgressBar \"[panel], show, [attribute]\" -- Show the progress bar panel with the attribute's value hidden AttributeProgressBar \"[panel], show, [attribute], show_value\" -- Show the progress bar panel with the attribute's value shown as well AttributeProgressBar \"[panel], hide\" -- Hide the progress bar Example // (From ai_cashmart_npc.p3s, Cashmart Helicopter boss) SetAttr \"flag_zombie 1\" TargetEntByName gameplay TargetToMem msGP SetAttr \"ea_dmg_absorb 95\" TargetPlayer 1 FireInput self,StartHunt // Show the Panel and assign our health attribute // (\"Postal III/p3/resource/UI/Hud/HeliHealthPanel.res\") AttributeProgressBar \"HeliHealthPanel,show,ea_health\" Timer tShout,5:2","title":"AttributeProgressBar"},{"location":"attributeprogressbar/#attributeprogressbar","text":"Add a panel with a progress bar on the HUD with an associated attribute for the \"progress\" value. Used for displaying boss/ally health bars and portraits in missions. Uses .res files located in \"Postal III/p3/resource/UI/Hud/\".","title":"AttributeProgressBar"},{"location":"attributes/","text":"Attributes In Postal3Script you are able to set or check Attributes, and execute states according to the results. All attributes in Postal3Script are integers only. When checking against multiple attributes at once you can use the \"and\" keyword. IfAttr Checks if an Attribute or Object has met a condition. The Attribute or Object MUST be set using the SetAttr statement first, or already exist. st_IfAttrTutorial { Group Neutral Patterns { pt_default { actions { // Check for my faction, if it's Zealots then I love animals IfAttr \"ea_faction == Faction:Zealots SetAttr LoveAnimals 1\" // My target is the player, so I will hate them IfAttr \"Object:target == Object:player SetAttr HatesPlayer 1\" // I have no ranged weapon, but I do have a melee weapon, then I'll bring up my weapon IfAttr \"HasWeapon:Ranged == 0 and HasWeapon:melee > 0 Block begin\" IfAttr \"HasWeapon:melee != 2 SetAttr WeaponChanged 1\" Weapon select,melee SetAttr \"ea_status sPUNISHER\" Block end // Player is forgiven according to the timer IfAttr \"Timer:tForgivePlayer < = 0 Pattern pt_end\" // State didn't execute from the Player, returning from this point IfAttr \"Object:caller != Object:player Return 1\" // My target loves animals?? No way! IfAttr \"target.LoveAnimals == 1 Return 1\" // My enemy of my enemy... is my enemy now! IfAttr \"target.Object:target != Object:null Block begin\" AssistTarget 1 Block end // My target is the Player, and they have their python out IfAttr \"Object:target == Object:player and target.ea_games == 1 State so_seepiss\" } } } } SetAttr Creates and sets a new attribute value if it doesn't exist, or just sets it if it already exists. Constants { Const YES,1 Const NO,0 } st_SetAttrTutorial { Group Neutral Patterns { pt_default { actions { SetAttr \"IamTheDevil 666\" // Supports constants SetAttr \"y_Yes YES\" SetAttr \"n_No NO\" SetAttr \"ea_status sNEUTRAL\" SetAttr \"reaction RE_NONE\" // Randomize non-existent attributes // Maximum possible is 100 // Second value should always be zero SetAttr \"rnd 0,0,100\" SetAttr \"rndtwo 25,0,75\" // Sets other object's attribute SetAttr \"target.cr_demo YES\" SetAttr \"caller.cr_demo NO\" } } } } CheckAttr Checks if an Attribute is true (equal to 1). st_CheckAttrTutorial { Group Neutral Patterns { pt_default { actions { CheckAttr \"flag_static Return 1\" CheckAttr \"greet_sleazy Say SLEEZ\" CheckAttr \"AnimalNotCat Say LIKESANIMAL\" CheckAttr \"AnimalCat Say LIKESANIMAL,LIKESCAT\" } } } } ChangeAttr Changes an already existing Attribute's value, increasing, decreasing, multiplying, or by halving. Halving will clamp the value to integer (5 / 2 wouldn't be '2.5', but '3'). st_ChangeAttrTutorial { Group Neutral Patterns { pt_default { actions { // Randomization ChangeAttr \"poo_rnd 0:100\" ChangeAttr \"combat_rnd 0:1\" ChangeAttr \"DonutsIHave +1\" ChangeAttr \"PooIGive -1\" ChangeAttr \"Multiply *5\" ChangeAttr \"Halve /5\" // Change Health on the fly ChangeAttr \"ea_health +25\" } } } } RemoveAttr Removes an already existing Attribute. Cannot be accessed and isn't set anymore. st_RemoveAttrTutorial { Group Neutral Patterns { pt_default { actions { RemoveAttr \"flag_PlayerFriendly\" RemoveAttr \"poo_rnd\" RemoveAttr \"IamTheDevil\" } } } }","title":"IfAttr, SetAttr, CheckAttr, ChangeAttr, RemoveAttr"},{"location":"attributes/#attributes","text":"In Postal3Script you are able to set or check Attributes, and execute states according to the results. All attributes in Postal3Script are integers only. When checking against multiple attributes at once you can use the \"and\" keyword.","title":"Attributes"},{"location":"callstate_callpattern/","text":"Note: It's advised to not use these functions - CallState Unused Postal3Script function Superseded by State Syntax CallState [state name] -- Exits out from current state, and enters new state - CallPattern Unused Postal3Script function Superseded by Pattern Syntax CallPattern [pattern name] -- Exits out from current pattern, and enters a new pattern in current state","title":"CallState, CallPattern"},{"location":"distto/","text":"DistTo Check the distance between one object to another. Syntax DistTo:[object] -- Returns the distance to the specified object // \"GLOBAL\" ENEMY DISTANCE CONSTANTS // Const ED_VERY_CLOSE,32 // Const ED_CLOSE,160 // Const ED_MIDDLE,320 // Const ED_FAR,768 // Const ED_FURTHER,1280 // Const ED_VERY_FAR,2048 // Turn to face the target if we're SUPER close to them // You may use any integer or one of the above specified constants instead... IfAttr \"DistTo:target < 16 Pattern pt_face\" // Caller is pretty far, so bombard them IfAttr \"DistTo:caller > ED_FAR Pattern pt_bombard\"","title":"DistTo"},{"location":"distto/#distto","text":"Check the distance between one object to another.","title":"DistTo"},{"location":"embedattributes/","text":"Embedded Attributes Instead of unexposed C++ variables in the source code, there are attributes that are already \"embedded\" and read from a related Postal3Script for given entities. For example, \"ea_health\" is the health of the entity that uses the assigned p3s behaviour, or the health of a set target, and can be read, changed, and set using the various \"Attr\" statements. Embedded Attributes have the \"ea_\" prefix. There are a variety of attributes and they each serve their own purposes. Embedded Attribute Example st_EmbeddedAttrTutorial { Group Neutral Patterns { pt_default { actions { // Embedded damage absorptions SetAttr \"ea_dmg_absorb 70\" SetAttr \"ea_bulletdmg_absorb 90\" SetAttr \"ea_clubdmg_absorb 70\" SetAttr \"ea_flamedmg_absorb 20\" SetAttr \"ea_blastdmg_absorb 30\" SetAttr \"ea_krotchydmg_absorb 100\" SetAttr \"ea_flamedmg_absorb 100\" SetAttr \"ea_physdmg_absorb 90\" SetAttr \"ea_blast_immune 1\" // NPC cannot do crit damage (kinda like in TF2) SetAttr \"ea_crit_disabled 1\" // NPC Faction check, please look at Factions IfAttr \"ea_faction == Faction:Police SetAttr tutorial_imacop 1\" // Health, if set to 0 NPC or Player will die IfAttr \"ea_health < 55 SetAttr tutorial_imwounded 1\" // NPC cannot be picked up (mainly used by Cats) SetAttr \"ea_takeable 0\" // NPC is no longer tased SetAttr \"ea_tased 0\" // NPC Manner, please look at Manners IfAttr \"ea_Manner == Manner:JusticeMan State bh_human:st_attack_melee\" // NPC Status, mainly used to determine if they are holding dangerous weapons SetAttr \"ea_status sNEUTRAL\" IfAttr \"ea_armed == WPN_M16 SetAttr NumAmmo AMMO_M16_MAX\" IfAttr \"ea_ActiveWeapon == Weapon:Ranged Aim true,false\" IfAttr \"ea_NumEnemies == 0 and ea_NumFear == 0 SetAttr tutorial_calm 1\" IfAttr \"ea_NumVisibleEnemy == 0 SetAttr TaskCombat TC_SEARCH\" // NPC will disappear if Player is too far away SetAttr \"ea_autokill 0\" // No gibbing SetAttr \"ea_no_gibs 1\" // Used for Segways IfAttr \"ea_lean != 1 Pattern pt_lean_in\" // NPC's Hammer name IfAttr \"ea_name == String:npc_pizza_vendor SetAttr cr_vendor 1\" // Ammo IfAttr \"ea_HaveAmmo == 0 Pattern pt_reload\" // Gibs CheckAttr \"ea_gibs\" } } } }","title":"Embedded Attributes"},{"location":"embedattributes/#embedded-attributes","text":"Instead of unexposed C++ variables in the source code, there are attributes that are already \"embedded\" and read from a related Postal3Script for given entities. For example, \"ea_health\" is the health of the entity that uses the assigned p3s behaviour, or the health of a set target, and can be read, changed, and set using the various \"Attr\" statements. Embedded Attributes have the \"ea_\" prefix. There are a variety of attributes and they each serve their own purposes.","title":"Embedded Attributes"},{"location":"enablegibs/","text":"EnableGibs Unused Postal3Script function Enables or Disables gibbing of an NPC Syntax EnableGibs true -- Enables gibbing (default) EnableGibs false -- Disables gibbing Example // from ai_st6_missions.p3s // This will force Uwe Boll to never gib on death/or when injured when he's spawned into the game st_init { Group Neutral patterns { pt_default { actions { EnableGibs false SetAttr \"UweTask UWE_WAITFORMISSION\" SetAttr \"ea_dmg_absorb 60\" Pattern bh_human:st_init.pt_default } } } }","title":"EnableGibs"},{"location":"enablegibs/#enablegibs","text":"Unused Postal3Script function Enables or Disables gibbing of an NPC","title":"EnableGibs"},{"location":"endmission/","text":"EndMission Ends the level, and proceeds to the next level (if possible) Equivalent to \"p3_end_mission\" console command Example // from ai_mission_daveland.p3s st_end { Group Neutral Patterns { pt_default { actions { EntFireInput lpp,Say:ENDEVENTINSANE Wait 1 EntFireInput muzak.mission,FadeOut:1 MissionLog done,escape EndMission 1 // Alternative way to end a mission EntFireInput \"pcc,Command:p3_end_mission\" } } } }","title":"EndMission"},{"location":"endmission/#endmission","text":"Ends the level, and proceeds to the next level (if possible) Equivalent to \"p3_end_mission\" console command","title":"EndMission"},{"location":"faction/","text":"Faction Each NPC, and even some generic entities, are set to belong to a specific faction. This is used for various things, such as checking for how we should act towards whole groups of specific NPC's, and what dispositions we should have against them. st_FactionTutorial { Group Neutral Patterns { pt_default { actions { // Here's a list of all Factions... IfAttr \"ea_faction == Faction:Police Return 1\" IfAttr \"ea_faction == Faction:Zealots Return 1\" IfAttr \"ea_faction == Faction:Citizens Return 1\" IfAttr \"ea_faction == Faction:Hobos Return 1\" IfAttr \"ea_faction == Faction:Animals Return 1\" IfAttr \"ea_faction == Faction:Player Return 1\" IfAttr \"ea_faction == Faction:LaserDot Return 1\" IfAttr \"ea_faction == Faction:Effects Return 1\" IfAttr \"ea_faction == Faction:Items Return 1\" IfAttr \"ea_faction == Faction:Taliban Return 1\" IfAttr \"ea_faction == Faction:Venezuela Return 1\" IfAttr \"ea_faction == Faction:ZombieBoss Return 1\" // Used by flag_zombie (Boss NPCs) // If our target is an animal, say we hate all animals! IfAttr \"target.ea_faction == Faction:Animals pt_SayHateAllAnimals\" } } } }","title":"Faction"},{"location":"faction/#faction","text":"Each NPC, and even some generic entities, are set to belong to a specific faction. This is used for various things, such as checking for how we should act towards whole groups of specific NPC's, and what dispositions we should have against them. st_FactionTutorial { Group Neutral Patterns { pt_default { actions { // Here's a list of all Factions... IfAttr \"ea_faction == Faction:Police Return 1\" IfAttr \"ea_faction == Faction:Zealots Return 1\" IfAttr \"ea_faction == Faction:Citizens Return 1\" IfAttr \"ea_faction == Faction:Hobos Return 1\" IfAttr \"ea_faction == Faction:Animals Return 1\" IfAttr \"ea_faction == Faction:Player Return 1\" IfAttr \"ea_faction == Faction:LaserDot Return 1\" IfAttr \"ea_faction == Faction:Effects Return 1\" IfAttr \"ea_faction == Faction:Items Return 1\" IfAttr \"ea_faction == Faction:Taliban Return 1\" IfAttr \"ea_faction == Faction:Venezuela Return 1\" IfAttr \"ea_faction == Faction:ZombieBoss Return 1\" // Used by flag_zombie (Boss NPCs) // If our target is an animal, say we hate all animals! IfAttr \"target.ea_faction == Faction:Animals pt_SayHateAllAnimals\" } } } }","title":"Faction"},{"location":"func_state_pattern_executepattern/","text":"- State Exits from current state, and enters a new state Syntax State [state name] -- Sets the new state Example // On start after 5 seconds it will exit from st_start and enter st_new_start, and back forth st_start { Group Neutral Patterns { pt_default { actions { Wait 5 State st_new_start } } } } st_new_start { Group Neutral Patterns { pt_default { actions { Wait 5 ChangeAttr \"TimeTicking +1\" State st_start } } } } - Pattern Exits from current pattern from current state, and enters a new pattern in the current state Syntax pattern [pattern name] -- Sets the new pattern Example // State initially enters \"pt_default\" pattern, but will move to \"pt_follow\" and will be there endlessly // from ai_cashmart.p3s st_idle { Group Neutral Patterns { pt_default { actions { TargetPlayer 1 Face true LookAt 1 Pattern pt_follow } } pt_follow { actions { MoveToTarget true,2 Wait 10 Pattern pt_follow } events { OnTargetReach \"Pattern pt_wait\" } } pt_wait { actions { IfAttr \"DistTo:target > 150 Pattern pt_follow\" Repeat 0.5 } } } } - ExecutePattern Executes a pattern outside of current state Syntax ExecutePattern [actor name]:[state name].[pattern name] -- Executes this pattern Example // This will execute bh_base's st_init's pt_default pattern ExecutePattern bh_base:st_init.pt_default // This will execute the state and pattern called \"st_onDeath.pt_default\" found from the caller's actor ExecutePattern st_OnDeath.pt_default // This will execute a pattern that exists in the state the script is currently running from ExecutePattern .xpt_shout","title":"State, Pattern, ExecutePattern"},{"location":"func_state_pattern_executepattern/#-state","text":"Exits from current state, and enters a new state","title":"- State"},{"location":"hit/","text":"Hit Sets weapon proficiency and forces the NPC to attack Syntax Hit [float] -- Sets weapon proficiency, and attacks if possible // from ai_st_init.p3s Const SPREAD_BLIND,20 Const SPREAD_MAX,10 Const SPREAD_WIDE,6 Const SPREAD_NORMAL,3 Const SPREAD_ACCURACY,1 // from ai_mission_as.p3s Const SPRD_SNIPE_NERD,5 Const SPRD_NORM_NERD,10 Const SPRD_MOVE_NERD,20 Const SPRD_LEAN_NERD,40 Example // from ai_mission_jwb.p3s pt_attack { actions { ExecutePattern .xpt_SayFight // NPC is a pro at shooting Hit 1 Wait 1 State st_start } } // from ai_mission_pdb.p3s // NPC is seemingly stupid at firing, but when you get closer you'll get punished pt_attack { actions { TargetPlayer 1 ExecutePattern .xpt_say IfAttr \"slot#msGP.PlayerNear == 0 Block begin\" Hit SPREAD_BLIND Wait 1:2 Block end IfAttr \"slot#msGP.PlayerNear == 1 Block begin\" Hit SPREAD_ACCURACY FireEvent Hit ChangeAttr \"target.ea_health -15\" Wait 0.5 Block end Repeat 0 } }","title":"Hit"},{"location":"hit/#hit","text":"Sets weapon proficiency and forces the NPC to attack","title":"Hit"},{"location":"manner/","text":"Manner Each NPC and even some generic entities, have a specific Manner assigned to them. This is essentially the same thing as Faction but on a more individual level. This is used for various things, such as setting and checking how a specific NPC belonging to a faction actually BEHAVES to then make another NPC act accordingly towards them. For example, preventing us from punching someone we dislike, and instead just shoving them because our manner is set as \"GayGuy\". (TODO: Manner bias towards other NPC must be researched to fully understand it) st_MannerTutorial { Group Neutral Patterns { pt_default { actions { // Here's a list of all Manners... IfAttr \"ea_Manner == Manner:Player Return 1\" IfAttr \"ea_Manner == Manner:StreetBro Return 1\" IfAttr \"ea_Manner == Manner:JusticeMan Return 1\" IfAttr \"ea_Manner == Manner:StGranny Return 1\" IfAttr \"ea_Manner == Manner:LameWanker Return 1\" IfAttr \"ea_Manner == Manner:SoccerMom Return 1\" IfAttr \"ea_Manner == Manner:CuteGirl Return 1\" IfAttr \"ea_Manner == Manner:Vendor Return 1\" IfAttr \"ea_Manner == Manner:RedNeck Return 1\" IfAttr \"ea_Manner == Manner:SushiNinja Return 1\" IfAttr \"ea_Manner == Manner:Girl Return 1\" IfAttr \"ea_Manner == Manner:MedicDoc Return 1\" IfAttr \"ea_Manner == Manner:StrayDog Return 1\" IfAttr \"ea_Manner == Manner:MonkeyApe Return 1\" IfAttr \"ea_Manner == Manner:PussyCat Return 1\" IfAttr \"ea_Manner == Manner:JihadBeard Return 1\" IfAttr \"ea_Manner == Manner:RhinoCow Return 1\" IfAttr \"ea_Manner == Manner:LaserDot Return 1\" IfAttr \"ea_Manner == Manner:Mission Return 1\" IfAttr \"ea_Manner == Manner:Pigeon Return 1\" IfAttr \"ea_Manner == Manner:GayGuy Return 1\" IfAttr \"ea_Manner == Manner:NerdyNerd Return 1\" IfAttr \"ea_Manner == Manner:Bystander Return 1\" // Don't continue if we're not a StreetBro... IfAttr \"ea_manner != Manner:StreetBro Return 1\" // If the target's manner is lame wanker, bully the poor guy! IfAttr \"target.ea_manner == Manner:LameWanker Pattern pt_Bully\" } } } }","title":"Manner"},{"location":"manner/#manner","text":"Each NPC and even some generic entities, have a specific Manner assigned to them. This is essentially the same thing as Faction but on a more individual level. This is used for various things, such as setting and checking how a specific NPC belonging to a faction actually BEHAVES to then make another NPC act accordingly towards them. For example, preventing us from punching someone we dislike, and instead just shoving them because our manner is set as \"GayGuy\". (TODO: Manner bias towards other NPC must be researched to fully understand it) st_MannerTutorial { Group Neutral Patterns { pt_default { actions { // Here's a list of all Manners... IfAttr \"ea_Manner == Manner:Player Return 1\" IfAttr \"ea_Manner == Manner:StreetBro Return 1\" IfAttr \"ea_Manner == Manner:JusticeMan Return 1\" IfAttr \"ea_Manner == Manner:StGranny Return 1\" IfAttr \"ea_Manner == Manner:LameWanker Return 1\" IfAttr \"ea_Manner == Manner:SoccerMom Return 1\" IfAttr \"ea_Manner == Manner:CuteGirl Return 1\" IfAttr \"ea_Manner == Manner:Vendor Return 1\" IfAttr \"ea_Manner == Manner:RedNeck Return 1\" IfAttr \"ea_Manner == Manner:SushiNinja Return 1\" IfAttr \"ea_Manner == Manner:Girl Return 1\" IfAttr \"ea_Manner == Manner:MedicDoc Return 1\" IfAttr \"ea_Manner == Manner:StrayDog Return 1\" IfAttr \"ea_Manner == Manner:MonkeyApe Return 1\" IfAttr \"ea_Manner == Manner:PussyCat Return 1\" IfAttr \"ea_Manner == Manner:JihadBeard Return 1\" IfAttr \"ea_Manner == Manner:RhinoCow Return 1\" IfAttr \"ea_Manner == Manner:LaserDot Return 1\" IfAttr \"ea_Manner == Manner:Mission Return 1\" IfAttr \"ea_Manner == Manner:Pigeon Return 1\" IfAttr \"ea_Manner == Manner:GayGuy Return 1\" IfAttr \"ea_Manner == Manner:NerdyNerd Return 1\" IfAttr \"ea_Manner == Manner:Bystander Return 1\" // Don't continue if we're not a StreetBro... IfAttr \"ea_manner != Manner:StreetBro Return 1\" // If the target's manner is lame wanker, bully the poor guy! IfAttr \"target.ea_manner == Manner:LameWanker Pattern pt_Bully\" } } } }","title":"Manner"},{"location":"missionlog_save_briefing/","text":"- MissionLog Adds missions/jobs/objectives on the Player's mission log. Syntax MissionLog clear_all -- Clears all objectives from the log MissionLog add_primary, [obj], [text/string] -- Adds primary objective to the log MissionLog add_secondary, [obj], [text/string] -- Adds secondary objective to the log MissionLog done, [obj1], [obj2], .. -- Objective(s) marked as done MissionLog fail, [obj1], [obj2], .. -- Objective(s) marked as failed MissionLog removed, [obj1], [obj2], .. -- Objective(s) removed without a trace MissionLog disable -- Mission log is disabled MissionLog enable -- Mission log is enabled Example // from ai_mission_jwb.p3s st_start { group Neutral patterns { pt_default { actions { PlayerKarma hide EntFireInput \"lpp,GiveWeapon:p3_weapon_taser\" EntFireInput \"pcc,Command:use p3_weapon_taser\" ExecutePattern .xpt_show_momleft ExecutePattern st_util.xpt_ShowMissionDesc // Adds the objective to the Player's log \"Jen must survive\" MissionLog add_primary,JenSurvive,#P3_JWB_PRIMARY_JEN ExecutePattern .xpt_secondary ShowMessage #P3_JWB_START ShowMessage #P3_JWB_HELPER01 Pattern pt_loop } } // All Soccer Moms have left pt_end { actions { // Objectives marked as done MissionLog done,MomsLeft MissionLog done,JenSurvive SetAttr \"NonLethalDone 1\" IfAttr \"PoliceIsHere == 1 RemoveAttr NonLethalDone\" // Player didn't harm anyone CheckAttr \"NonLethalDone MissionLog done,NonLethal\" EntFireInput fade_in,fade Wait 1 EntFireInput \"pcc,Command:video_exitcmd jwb_3 p3_end_mission\" } } } } - MissionSave Unused Postal3Script function Not recommended to use Syntax MissionSave [string] -- Saves the game Technical Details When \"MissionSave\" is called in p3s, it will do \"save P3M_[string] mission [string]\" in console, where [string] is replaced with the parameter. It was to be used or related to 'MissionLog', but it looks like it's underdeveloped. Example // This will create a p3m_b4_zombie_ambush.sav and .tga file in the SAVE folder MissionSave b4_zombie_ambush - MissionBriefing Unused Postal3Script function Shows a message on the screen with black background, with a \"Press ENTER to continue\" prompt. Equivalent to \"gameui_show_p3_briefdlg [string]\" console command, which was also used ONLY in the Paradise Bridge level. Example // This will show the very first text screen of Paradise Bridge level MissionBriefing \"#P3_PDB_T01_ONSCREEN\" // This will do the same, but after the pdb_00.bik stopped playing after execution EntFireInput \"pcc,Command:video_exitcmd pdb_00 gameui_show_p3_briefdlg #P3_PDB_T01_ONSCREEN\"","title":"MissionLog, MissionSave, MissionBriefing"},{"location":"missionlog_save_briefing/#-missionlog","text":"Adds missions/jobs/objectives on the Player's mission log.","title":"- MissionLog"},{"location":"movement_funcs/","text":"- Move Sets the NPC's movement Syntax Move run -- NPC will now run Move walk -- NPC will now walk Move true -- NPC is able to move Move false -- NPC is no longer able to move Move [walk/run], [angle], [timing], [face_dir/update_dir] -- todo - MoveToLean Moves the NPC to a lean spot, used for combat Syntax // ENEMY DISTANCE (from ai_st_init.p3s) Const ED_VERY_CLOSE,32 Const ED_CLOSE,160 Const ED_MIDDLE,320 Const ED_FAR,768 Const ED_FURTHER,1280 Const ED_VERY_FAR,2048 // Flags nearest nearest_to_target in_viewcone visible notvisible_totarget far check_dotproduct check_onmoving not_behind_target safe area_group MoveToLean run, [distance_min], [distance_max], [flag1], [flag2], [flag3], .. Example // from ai_cashmart.p3s st_combat_hide { Group Combat Patterns { pt_hide_param { actions { ExecutePattern st_combat_logic.xpt_setAreaGroup MoveToLean run,ED_CLOSE,ED_FAR,notvisible_totarget Pattern pt_hide_loop } } } } - MoveToTarget Forces the NPC to move to it's target Syntax // Flags none to_target from_target target_dir Todo: this is not really correct, It's not clear what each argument does just by looking at p3s scripts, it's a rough estimation MoveToTarget [run/walk/true], [distance_min], [distance_max], [flag] MoveToTarget [run/walk/true], [distance], [flag] MoveToTarget [false] // from ai_mission_sbe.p3s pt_chase { actions { TargetEntByName npc_slave MoveToTarget run,1 CheckTarget 1 Repeat 1 } events { OnTimer_tChaseSlave \"Pattern pt_stop_chase\" } } - MoveToTargetLKP Forces the NPC to move to it's target (todo: what does LKP mean?) Syntax MoveToTargetLKP [run/walk/true]","title":"Move, MoveToLean, MoveToTarget, MoveToTargetLKP"},{"location":"movement_funcs/#-move","text":"Sets the NPC's movement","title":"- Move"},{"location":"name/","text":"Name The name of a specified object, set via Hammer It is case-insensitive Syntax Name:[object] -- Returns the name of a specified object // If the name of our targeted object is \"npc_jen\" IfAttr \"Name:target == String:npc_jen Block begin\" // Set jen's health to zero SetAttr \"target.ea_health 0\" Block end","title":"Name"},{"location":"name/#name","text":"The name of a specified object, set via Hammer It is case-insensitive","title":"Name"},{"location":"object/","text":"Object An object or entity, such as an NPC or a prop. In Postal3Script you always have access to important objects such as a target or yourself, so you can check and do stuff to them. You don't always have access to the Caller, as it's heavily dependent on the Event that caused the NPC to enter the state. Typically, the caller means something or someone that forced the NPC to enter it. Syntax Object:[object] -- Returns the Object specified // In P3S you can check for the following objects: // 'Object:Caller' ; 'Object:Target' ; 'Object:Player' // 'Object:slot#0' ; 'Object:null' ; 'Object:self' // 'Object:item' ; 'Object:anchor' // Check if our caller exists (null means zero) IfAttr \"Object:caller != Object:null Block Begin\" // Was it the Player who forced us into this state? IfAttr \"Object:caller == Object:player Block Begin\" // Well then we are going to run to them, endlessly TargetPlayer 1 // or TargetCaller 1 MoveToTarget run,1,0 Block End Block End // Check if our target isn't the Player IfAttr \"Object:target != Object:null and Object:target != Object:Player Block Begin\" // Bad day for our enemy, though, because they are going to die instantly ChangeAttr \"target.ea_health -target.ea_health\" Block End // Object:self and Object:item are barely used, the latter is used by Motorhead // It's a pointer to the NPC's held item // Check out ai_motorhead.p3s, ai_st1_common.p3s, ai_st2_states.p3s // and ai_st7_environment.p3s // Object:anchor is used only in ai_mission_jwb.p3s (todo: what the hell it is?) Saving Objects To Memory You are capable of saving an object to memory, with up to 10 slots. This feature is typically used for keeping track of progress on tasks and related to mission logic. The 6 and 7 memory slot was never used. Cannot be higher than 10 or lower than 0. // (from ai_st_init.p3s) // Const msTEMP,0 // Const msOWNER,1 // Const msTARGET,2 // Const msENEMY,3 // Const msSUSPECTED,4 // Const msLEADER,5 // Const msDRIVEN,6 // Const msINTEREST,7 // Const msKILLER,8 // Const msGP,9 // Get entity named 'gameplay' and set it as target TargetEntByName gameplay // Save the target to memory TargetToMem msGP // Set the MathLogic's attribute ChangeAttr \"slot#msGP.MoneyGiven +5\" // Reset the target ResetTarget 1","title":"Object"},{"location":"object/#object","text":"An object or entity, such as an NPC or a prop. In Postal3Script you always have access to important objects such as a target or yourself, so you can check and do stuff to them. You don't always have access to the Caller, as it's heavily dependent on the Event that caused the NPC to enter the state. Typically, the caller means something or someone that forced the NPC to enter it.","title":"Object"},{"location":"opendialog/","text":"OpenDialog Opens the Yes/No dialog Unused/Unfinished Postal3Script function Technical Details Executes \"gameui_show_p3_yes_no_dialog\" console command with parameters // The console command will ignore any parameter OpenDialog 0 Events followed by Answer Depending on the answer, it will fire the event called \"OnDialogNo\" or \"OnDialogYes\" for the Actor that executed it. Normally it would mean the executed Actor would be the Player, but in this function there's no hardcoded check for the Player.","title":"OpenDialog"},{"location":"opendialog/#opendialog","text":"Opens the Yes/No dialog Unused/Unfinished Postal3Script function","title":"OpenDialog"},{"location":"playerkarma/","text":"PlayerKarma Sets the Player's karma globally Syntax (from ai_st_init.p3s) // KARMA AMOUNTS Const KARMA_LOW,5 Const KARMA_MED,10 Const KARMA_HIGH,25 Const KARMA_HALF,50 Const KARMA_FULL,100 PlayerKarma hide -- Hides the karma icon PlayerKarma show -- Shows the karma icon PlayerKarma good -- Player is now on good path (unused) PlayerKarma evil -- Player is now on evil path (unused) PlayerKarma +-*/=[value] -- Modifies the karma's value Example // from ai_mission_sbe.p3s xpt_OnPaparazziEscaped { actions { SetAttr \"PhotoTaken 1\" MissionLog fail,photos // Player lost some good guy points CheckAttr \"PhotoTaken PlayerKarma -KARMA_HIGH\" } }","title":"PlayerKarma"},{"location":"playerkarma/#playerkarma","text":"Sets the Player's karma globally","title":"PlayerKarma"},{"location":"playvideo/","text":"PlayVideo Plays a .bik video located in \"Postal III\\p3_english\\media\". Syntax PlayVideo [filename], [fade_in_time], [fade_out_time], [console_command(s) to execute after video is finished playing] Technical Details Will execute \"p3_playvideo\" or \"p3_playvideo_exitcommand\" console commands Syntax for \"p3_playvideo_exitcommand\" is 'filename', 'exitcommand', 'fadein', 'fadeout' Syntax for \"p3_playvideo\" is 'filename', 'fadein', 'fadeout' Example // Fades in and fades out in 1.5 seconds PlayVideo placeholder, 1.5, 1.5 // Fades in and fades out in 1 second PlayVideo thebigrevenge, 1, 1 // Alternative (requires pcc entity in the level) EntFireInput \"pcc,Command:playvideo thebigrevenge\" // Another alternative // Will play music, and text after video had ended EntFireInput \"pcc,Command:playgamesound Music.IntroStinger\" EntFireInput \"pcc,Command:video_exitcmd notimportant gameui_show_p3_briefdlg #CR_MONDAY_BRIEFING\" Notes/Issues * Depending on which command will you use for video playing, it will become unskippable. * Postal3Script is too slow to play an intro movie on the beginning of a map, causing it you to see the map for a brief second before eventually playing the movie.","title":"PlayVideo"},{"location":"playvideo/#playvideo","text":"Plays a .bik video located in \"Postal III\\p3_english\\media\".","title":"PlayVideo"},{"location":"push/","text":"Push Performs a melee attack Syntax Push self, target, easy -- Plays flinching animations, but no damage Push self, target, medium -- Deals slight damage to target Push self, target, hard -- Deals heavy damage to target Victim and attacker cannot be the same Example // from ai_citizen.p3s // Plays animation and deals damage at the same time pt_bump { actions { TargetCaller 1 TargetToMem msTARGET IfAttr \"ea_Manner == Manner:RedNeck and slot#msTARGET.ea_Manner == StreetBro Block begin\" Face true Sequence seq.melee_push Push self,target,medium Block end IfAttr \"ea_Manner == Manner:StreetBro and slot#msTARGET.ea_Manner == StreetBro Block begin\" Face true Sequence seq.melee_push Push self,target,medium Block end IfAttr \"ea_Manner == Manner:CuteGirl and slot#msTARGET.ea_Manner == StreetBro Block begin\" Face true Sequence seq.melee_push Push self,target,medium Block end State st_start } }","title":"Push"},{"location":"push/#push","text":"Performs a melee attack","title":"Push"},{"location":"say/","text":"Say Make an NPC say a specified \"sentence\" type voice line. Uses the name of the sentence in the related NPC's sentence script located in \"Postal III\\p3\\scripts\\Sentences\". The voice prefix is not required, \"GAY_ONFIRE\" can lose the \"GAY_\" part and instead just be \"ONFIRE\" for example... If you want the player to say something you must EntFireInput logic_playerproxy to do a generic say instead, like this: \"EntFireInput proxy,Say:SENTENCENAME\". // Say a voice line... Say ZOMB_MOAN // Pick and say one of these voice lines randomly... Say ZOMB_MOAN,ZOMB_CURSE,ZOMB_HIT // Pick and say one of these voice lines randomly, and specify the optional sentence // priority parameter (TODO: Need to make sure that is actually what that parameter even is) - Tim // SENTENCE PRIORITY PARAMETERS // SENTENCE_PRIORITY_NORMAL = 0, // SENTENCE_PRIORITY_MEDIUM = 1, // SENTENCE_PRIORITY_HIGH = 2, Say ZOMB_MOAN,ZOMB_CURSE,ZOMB_HIT,0","title":"Say"},{"location":"say/#say","text":"Make an NPC say a specified \"sentence\" type voice line. Uses the name of the sentence in the related NPC's sentence script located in \"Postal III\\p3\\scripts\\Sentences\". The voice prefix is not required, \"GAY_ONFIRE\" can lose the \"GAY_\" part and instead just be \"ONFIRE\" for example... If you want the player to say something you must EntFireInput logic_playerproxy to do a generic say instead, like this: \"EntFireInput proxy,Say:SENTENCENAME\". // Say a voice line... Say ZOMB_MOAN // Pick and say one of these voice lines randomly... Say ZOMB_MOAN,ZOMB_CURSE,ZOMB_HIT // Pick and say one of these voice lines randomly, and specify the optional sentence // priority parameter (TODO: Need to make sure that is actually what that parameter even is) - Tim // SENTENCE PRIORITY PARAMETERS // SENTENCE_PRIORITY_NORMAL = 0, // SENTENCE_PRIORITY_MEDIUM = 1, // SENTENCE_PRIORITY_HIGH = 2, Say ZOMB_MOAN,ZOMB_CURSE,ZOMB_HIT,0","title":"Say"},{"location":"showmessage_showhint/","text":"- ShowMessage Prints out message to the screen Supports strings from \"Postal III/p3/resource/p3_english.txt\" (or from any other file that contains valid strings) Equivalent to Half-Life 2's UserMessageBegin Uses data from \"Postal III/p3/scripts/HudLayout.res\" (Plus \"channels_manifest.txt\" and \"HudAnimations.txt\") Example // This will print on the screen ShowMessage \"#P3_CM_INSANE1\" // This will print on the P3Karma channel ShowMessage \"[Ja-ja, nat\u00fcrlich!], $P3Karma\" // This will print on the P3Mission channel ShowMessage \"[Puff! Puff! Puff!], $P3Mission\" // This will print on the P3Debug channel ShowMessage \"[Meow!... I'm on Fear!!!], $P3Debug\" // You have arrested 0-3 of 3 hobos ChangeAttr \"HoboArrested 1\" ShowMessage \"[You have arrested {0:v} of 3 hobos], $P3Mission, HoboArrested\" // Slightly more complex syntax IfAttr \"caller.ea_Manner == Manner:PussyCat and mis_004 >= 0 Block begin,execute\" TargetEntByName mg_004 SetAttr \"mis_004 cat_counter\" IfAttr \"mis_004 >= target.condition SetAttr mis_004 target.condition\" ShowMessage \"[ {0:v} of {1:v} deceased cats have been obtained], $P3Mission, mis_004, target.condition\" Block end - ShowHint Unused Postal3Script function Karma hinting is done automatically, so this has been left completely unused Uses data from \"Postal III/p3/scripts/hints_manifest.txt\" Example // First found in 'ai_st1_common.p3s' Line 954 ShowHint hintCat // First found in 'ai_st6_missions.p3s' Line 528 ShowHint hintKarmaDown ShowHint hintKarmaUp","title":"ShowMessage, ShowHint"},{"location":"showmessage_showhint/#-showmessage","text":"Prints out message to the screen Supports strings from \"Postal III/p3/resource/p3_english.txt\" (or from any other file that contains valid strings) Equivalent to Half-Life 2's UserMessageBegin Uses data from \"Postal III/p3/scripts/HudLayout.res\" (Plus \"channels_manifest.txt\" and \"HudAnimations.txt\")","title":"- ShowMessage"},{"location":"statematrix/","text":"StateMatrix Matrix to check through manners, factions, and act accordingly to that Instead of creating a lot of ifs, a function was created for this * To check what each matrix does, check out \"ai_matrix.p3s\" * Heavily used in \"ai_mission_pw.p3s\" * Function uses target Syntax StateMatrix faction -- Goes through Faction matrix, and calls states StateMatrix social -- Goes through Social matrix, and calls states Example // todo?","title":"StateMatrix"},{"location":"statematrix/#statematrix","text":"Matrix to check through manners, factions, and act accordingly to that Instead of creating a lot of ifs, a function was created for this * To check what each matrix does, check out \"ai_matrix.p3s\" * Heavily used in \"ai_mission_pw.p3s\" * Function uses target","title":"StateMatrix"},{"location":"stunout/","text":"StunOut Unused Postal3Script function Stuns an NPC, as if they were shot by a Taser, and collapses Syntax StunOut 1 -- Stuns NPC Example // from ai_st1_common.p3s (Line 1124) // Old Taser code pt_stunout:ignore_ext_events { actions { Effect 4,Tazer_Hit_Smoke_Fx,pelvis,0,0,-12,-1,true RemoveAttr on_tased Timer tTASED,0 IfAttr \"MissionCharacter > 0 ExecutePattern ut_set_mis.pt_stunout\" // Stun the NPC StunOut 1 Wait 3:6 Effect 4,reset Pattern pt_fakedeath } events { OnDeath \"ExecutePattern .xpt_death\" } }","title":"StunOut"},{"location":"stunout/#stunout","text":"Unused Postal3Script function Stuns an NPC, as if they were shot by a Taser, and collapses","title":"StunOut"},{"location":"travelbypathtrack/","text":"TravelByPathTrack Forces an NPC's movement to be limited by Path tracks Syntax TravelByPathTrack [name of path track in hammer] -- Limit movement to this Pathtrack Example // from ai_mission_gri.p3s st_moveout { group Neutral patterns { pt_default { actions { // This is our target TargetEntByName target_rhino // Move according to \"pt_rhino1\" named Path track TravelByPathTrack pt_rhino1 // Do this until we reached our target // Then exit from this state IfAttr \"DistTo:target < ED_CLOSE State st_start\" Repeat 1 } } } events { OnRunOut \"State st_start\" OnUser1 \"Pattern st_start.pt_goberserk\" } } st_start { group Neutral patterns { pt_default { actions { IfAttr \"Crazy == 1 State st_berserk\" // Reset our movement so we are no longer bounded by Path track SetAreaGroup AG_DEFAULT:walkable,AG_rhino FreeMovementParams area_all,-1,-1,area_group FreeMovement run ExecutePattern pt_gallop } } } }","title":"TravelByPathTrack"},{"location":"travelbypathtrack/#travelbypathtrack","text":"Forces an NPC's movement to be limited by Path tracks","title":"TravelByPathTrack"},{"location":"turn_turnspeed/","text":"- Turn Changes the NPC's angle (from -360 to 360) Syntax Turn [integer] -- Increases angle Turn -[integer] -- Decreases angle Turn [integer]:[integer] -- Randomizes angle Example // from ai_mission_sbe.p3s pt_turn_left { actions { Move false SetAttr \"CornerType CORNER_RIGHT\" Turn -90 Wait 1 Pattern pt_move } } pt_turn_right { actions { Move false SetAttr \"CornerType CORNER_LEFT\" Turn 90 Wait 1 Pattern pt_move } } - TurnSpeed Sets the NPC's turning speed The default turning speed is 90 Syntax TurnSpeed idle, [integer] -- Sets idle speed TurnSpeed turn, [integer] -- Sets turn speed TurnSpeed walk, [integer] -- Sets walk speed TurnSpeed run, [integer] -- Sets run speed TurnSpeed attack, [integer] -- Sets attack speed TurnSpeed default, [integer] -- Sets default speed Example // from ai_st1_common.p3s TurnSpeed turn,15 TurnSpeed idle,15 TurnSpeed run,15 TurnSpeed walk,15 TurnSpeed attack,15 TurnSpeed default,15","title":"Turn, TurnSpeed"},{"location":"turn_turnspeed/#-turn","text":"Changes the NPC's angle (from -360 to 360)","title":"- Turn"},{"location":"visible/","text":"Visible Check if a specified object is visible. If 'Senses' is turned off, the NPC will never be able to \"see\" the target. Syntax Visible:[object] -- Returns if the specified object is visible or not // Make sure we are able to see Senses true // If we can fire our weapon and we can see the targeted object... IfAttr \"Timer:tCanFire == 0 and Visible:target == true Block begin\" // Try to shoot at the target, say we're shooting, and reset our fire timer ExecutePattern st_combat_logic.xpt_TryShoot ExecutePattern .xpt_SayShoot ExecutePattern .xpt_SetFireTimer Block end","title":"Visible"},{"location":"visible/#visible","text":"Check if a specified object is visible. If 'Senses' is turned off, the NPC will never be able to \"see\" the target.","title":"Visible"},{"location":"voiceprefix/","text":"VoicePrefix The prefix of an NPC's voice. The voice prefix can be found in the related NPC's sentence script located in \"Postal III\\p3\\scripts\\Sentences\". Everything before the underscore is considered the voice prefix. Syntax VoicePrefix:[object] -- Returns the voice prefix of the specified object // If we don't use the \"whore\" npc voice prefix // say a \"sentence\" type voice line about a cop going crazy // (whore npc's don't have any lines recorded for this scenario) IfAttr \"VoicePrefix:self != String:WHR Say MADCOP\"","title":"VoicePrefix"},{"location":"voiceprefix/#voiceprefix","text":"The prefix of an NPC's voice. The voice prefix can be found in the related NPC's sentence script located in \"Postal III\\p3\\scripts\\Sentences\". Everything before the underscore is considered the voice prefix.","title":"VoicePrefix"},{"location":"wait_waitforend_repeat/","text":"- Wait A Timer to wait before execution Syntax Wait [float] -- Wait before executing Wait [float]:[float] -- Randomized waiting time Example // from ai_mission_aa.p3s st_tank { Group Neutral Patterns { pt_default { actions { PlayVideo aa_2,1,1 // Wait this much to not spawn the Boss immediately Wait 1.2 MissionLog add_primary,tank,#P3_AA_LOG3 EntFireInput muzak.battle,FadeIn:1 EntFireInput hugo_spawner,Enable EntFireInput spawner_invaders,Enable ShowMessage #P3_AA_MSG3 } } } } - WaitForEnd Wait for an ongoing activity before execution Mostly used for sequences Syntax WaitForEnd 1 -- Wait for ending before execution Example // from ai_mission_cw.p3s st_opencage_02 { Group Alert Patterns { pt_default { actions { Weapon disarm Sequence seq.env_checking // Wait for \"env_checking\" animation to end WaitForEnd 1 Weapon arm EntFireInput \"door_dogs_02,OpenAwayFrom:!activator\" State st_start } } } } - Repeat Repeats a pattern every defined second(s) Syntax Repeat [float] -- Repeat every [float] seconds Example // This will create a loop in pt_loop endlessly, unless we exit from out it st_start { Group Neutral Patterns { pt_default { actions { PlayerKarma hide MissionLog disable Pattern pt_loop } } pt_loop { actions { Repeat 2 } } } }","title":"Wait, WaitForEnd, Repeat"},{"location":"wait_waitforend_repeat/#-wait","text":"A Timer to wait before execution","title":"- Wait"},{"location":"weapon_reload_throwgrenade/","text":"- Weapon Sets NPC's current weapon state Syntax Weapon select, melee -- Selects melee weapon, if available Weapon select, ranged -- Selects ranged weapon, if available Weapon arm -- Automatically selects weapon Weapon disarm -- Holsters active weapon Weapon drop -- Drops active weapon (won't drop if it's not out) Example // from ai_mission_pdb.p3s st_OnSprayStunned { Group Alert Patterns { pt_default { actions { AreaEvent ENEMY,16 // Drops weapon Weapon drop ExecutePattern bh_base:st_OnSprayStunned.pt_default } } } } // from ai_mission_srm.p3s // This will unholster it's weapon and aim at the Player pt_attack { actions { Timer attacktimer,2:3,repeated TargetPlayer 1 MoveToTarget false FreeMovement false Weapon Arm Aim true State st_hitit } } - Reload Forces NPC to reload it's weapon Syntax Reload 1 -- Reloads Example // from ai_npc_military.p3s (stripped out) pt_default { actions { IfAttr \"ea_HaveAmmo == 0 Block begin\" ExecutePattern st_reload.xpt_prereload Reload 1 WaitForEnd 1 Block end State st_start } } - ThrowGrenade Forces NPC to throw a grenade Syntax // Grenade types frag smoke flash beenest molotov krotchy_toy ThrowGrenade 1, [grenade type], no_ally -- Throws grenade, optional flag Example // This AI will do nothing but throw grenades at the Player every 5 seconds behavior { name bh_molotovthrower inherited bh_human States { st_start { Group Neutral Patterns { pt_default { actions { SetSquadRelation player_squad:enemy:10 TargetPlayer 1 Wait 1 ThrowGrenade 1, molotov Repeat 5 } } } } } }","title":"Weapon, Reload, ThrowGrenade"},{"location":"weapon_reload_throwgrenade/#-weapon","text":"Sets NPC's current weapon state","title":"- Weapon"}]}