<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="WhackJob Interactive">
  <link rel="canonical" href="https://kizoky.github.io/postal3script/">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>What is Postal3Script? - Postal3Script</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "What is Postal3Script?";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = "/postal3script/";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> Postal3Script</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">-- Postal3Script (WIP) --</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href=".">What is Postal3Script?</a>
    <ul class="current">
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Structure (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">States (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Patterns (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Blocks (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Events (TBD)</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Attribute Checking --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="attributes/">IfAttr, SetAttr, CheckAttr, ChangeAttr, RemoveAttr</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="embedattributes/">Embedded Attributes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Object Categories (WIP) --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="manner/">Manner</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="faction/">Faction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">ItemType (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">String (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Timer (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="object/">Object</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="distto/">DistTo</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">AngleTo (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="visible/">Visible</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">HasWeapon (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">RelationTo (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Relation (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="name/">Name</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Ammo (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Ignore (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Karma (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="voiceprefix/">VoicePrefix</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Functions (WIP) --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Effect (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="say/">Say</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">FireEvent, FireEventEX, FireUser, FireInput, AreaEvent, EntFireUser, EntFireInput (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">SetSquad, SetSquadRelation, RemoveSquadRelation, RallySquad, DesertSquad (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">TargetEnemy, TargetPlayer, TargetCaller, TargetItem, TargetAnchor, TargetVehicle, TargetHostage, TargetCrosshair, TargetEntByName, ResetTarget, IgnoreTarget, SetTarget (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">TargetToMem, TargetFromMem, CallerToMem, ClearMem, SendTarget2Caller (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Gesture, ResetGesture, ResetSequence (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Aim, Senses, Snatch, Unsnatch, Crouch, Face, Lean, Follow, LookAt, HolsterWeapon, Anchor, Busy, Fear, Hate, CatDervish, PlayerFriendly, LookOut (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Headblob (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">EmitSound (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Item, SpawnItem (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">Relationship (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">EnterVehicle (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="assisttarget_enemy/">AssistTarget, AssistEnemy, ArrestTarget, BusyTarget, CheckTarget, CheckLOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="NPC/">NPC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="stunout/">StunOut</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="enablegibs/">EnableGibs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="addfluid/">AddFluid</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- State Functions --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="func_state_pattern_executepattern/">State, Pattern, ExecutePattern</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="wait_waitforend_repeat/">Wait, WaitForEnd, Repeat</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="statematrix/">StateMatrix</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="callstate_callpattern/">CallState, CallPattern</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="activitypattern_funcs/">StoreActivityPattern, ExecuteActivityPattern, ClearActivityPattern</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Movement Functions --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="movement_funcs/">Move, MoveToLean, MoveToTarget, MoveToTargetLKP</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">FreeMovement, FreeMovementParams (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="travelbypathtrack/">TravelByPathTrack</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">SetHintGroup, SetAreaGroup, SetLeanGroup, AvoidProhibitedArea (TBD)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="turn_turnspeed/">Turn, TurnSpeed</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="TBD/">SetActPack (TBD)</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Attack Functions --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="hit/">Hit</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="push/">Push</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="weapon_reload_throwgrenade/">Weapon, Reload, ThrowGrenade</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Mission Functions --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="attributeprogressbar/">AttributeProgressBar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="missionlog_save_briefing/">MissionLog, MissionSave, MissionBriefing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="showmessage_showhint/">ShowMessage, ShowHint</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="endmission/">EndMission</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="playerkarma/">PlayerKarma</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="playvideo/">PlayVideo</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="opendialog/">OpenDialog</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">-- Deleted Functions --</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="arm/">Arm</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">Postal3Script</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
        
          <li>-- Postal3Script (WIP) -- &raquo;</li>
        
      
    
    <li>What is Postal3Script?</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="what-is-postal3script">What is Postal3Script?</h1>
<p>Postal3Script, or P3S, is a scripting language developed for Postal 3, designed to handle most of the NPC AI and mission scripting.
It allows for a much easier and faster time doing missions and AI rather than messing around in C++ and doing logic entirely through map entities in Hammer.
<p>With Postal3Script, you can easily do many things that you normally would not be able to do without the source code of the game due to the many useful functions and attributes that are interfaced.
<p>P3S script files are located in "/Postal III/p3/scripts" and use the ".p3s" file extension. To load and be able to use a p3s script, you must add it to a manifest, in "ai_scripts.txt", found in the previously mentioned folder.
<p>Changes to p3s scripts will automatically hotload when the map restarts, so you can just use the "restart" console command without ever having to exit and reload the game.

<h2>Postal3Script Example</h2>
<pre><code class="language-js">
Constants
{
    Const DONUTS_INCR,1
    Const SOMEBODY_STOLE_MY_DONUTS,15
    Const YES,1
    Const NO,0
}

behavior
{
    name bh_evensuperioractor
    inherited bh_mysuperioractor

    States
    {
        st_mycustomstate
        {
            Group Alert
            Patterns
            {
                pt_default
                {
                    // Only executes when on Alert
                }
            }
        }

        st_nowyallgonnapay
        {
            Group Combat
            Patterns
            {
                pt_default
                {
                    // Only executes when in Combat
                    SetAttr "veryverypissedoff YES"
                    Pattern pt_donuts
                }

                pt_donuts
                {
                    IfAttr "veryverypissedoff == YES Pattern st_nowyallgonnapay.pt_allgood"
                }

                pt_allgood
                {
                    SetAttr "veryverypissedoff NO"
                }
            }
        }
        events
        {
            OnDeath "ExecutePattern st_OnDeath.pt_default"
            OnTimer_tUnstun "Pattern pt_end"
            OnUnconscious "Pattern pt_unconscious"
            OnHostaged "Pattern pt_hostaged"
            OnSprayStunned "Timer tUnstun,SPRAY_UNSTUN_TIMER"
            OnTimer_tScream "ExecutePattern .xpt_SayScream"
            OnUnstunned "Pattern pt_end"
            OnStandUpEnd "Pattern pt_end"
        }

        // Sets on spawn
        st_init
        {
            Group Neutral
            Patterns
            {
                pt_default
                {
                    actions
                    {
                        Senses false
                    }
                }
            }
        }

        // Called continously
        st_start
        {
            Group Neutral
            Patterns
            {
                pt_default
                {
                    actions
                    {
                        // tick
                    }
                }
            }
        }
    }
}
</code></pre>
<h1> Limitations </h1>
<p>Each state can hold events, which in turn can execute patterns. Patterns can be inherited from other P3S actors, as well as Attributes.
<p>* In Postal3Script, Attributes can only be whole numbers/integers, attributes can't be floats, doubles and strings.
<p>* An Attribute must have a value initialized before checking it's value using CheckAttr, meaning an attribute that doesn't exist will never return a valid value. (Checking if it's zero/null doesn't work).
<p>* You can only have a limited number of if statements in a single state or pattern.

<h1> Debugging code </h1>
<p>Normally the game doesn't print out any errors, you need to have the "developer" and "p3_fsm_spew" console commands enabled.</p>
<p>Scrolling around in the console should show you which script and what lines have errors if there are any.
<p>If you want to print out your own debug messages, You'll have to settle for doing EntFireInput on the point_clientcommand in the map via "EntFireInput pcc,Command: echo yourmessagehere". Debug channel specific ShowMessages are broken it seems.

<h1> Unused Postal3Script files </h1>
<p>Trashmasters have left many p3s scripts that were used during the development of Postal III just sitting around.
<p>Many of them contain cut features, unused logic, and various tests.
<pre><code class="language-js">
'ai_badger_test.p3s' - Badger testing
'ai_cashmart.p3s' - Earlier version of Cashmart (ai_cashmart_npc.p3s is not unused)
'ai_gameplay.p3s' - Intended for Open World gameplay
'ai_patrol1_citizen_fight.p3s' - Unknown
'ai_st1_common.p3s' - Contains various old code
'ai_st2_states.p3s' - Contains various old code
'ai_st3_social.p3s' - Contains experimental old code
'ai_st4_queuie.p3s' - Queue testing
'ai_st5_temp.p3s' - Contains test code, scrapped features
'ai_st6_missions.p3s' - Test code related to missions
'ai_st7_environment.p3s' - Code related to cut environment behavior
'ai_st8_items.p3s' - Code related to cut inventory items
'ai_st9_animals.p3s' - Animals test
'ai_st10_temp.p3s' - Test script, contains code related to Traffic lights
'ai_st11_urza.p3s' - Contains scrapped features, old code
'ai_st12_urza.p3s' - Contains scrapped features, old code
'ai_st98_helicopter.p3s' - Code that's identical to today's Helicopter AI
'ai_st_utilities.p3s' - Various code related to NPCs
'ai_test_babuska.p3s' - Test script
'lean_test.p3s' - Test script
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="TBD/" class="btn btn-neutral float-right" title="Structure (TBD)">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Written by Kizoky and Pseudonym_Tim <br>© WhackJob Interactive 2022<br>ㅤ</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="TBD/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
